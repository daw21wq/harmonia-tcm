<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HarmoniaTCM - Medycyna Chi≈Ñska z AI</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { 
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            padding: 15px; border-radius: 15px; margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .logo { text-align: center; font-size: 28px; font-weight: bold; color: #4CAF50; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #666; font-size: 16px; }
        .login-form { 
            background: white; padding: 30px; border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); max-width: 400px; margin: 50px auto;
        }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
        .form-group input { 
            width: 100%; padding: 12px; border: 2px solid #e1e5e9; border-radius: 10px;
            font-size: 16px; transition: border-color 0.3s;
        }
        .form-group input:focus { outline: none; border-color: #4CAF50; }
        .btn { 
            width: 100%; padding: 15px; background: #4CAF50; color: white; border: none;
            border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;
            transition: background 0.3s;
        }
        .btn:hover { background: #45a049; }
        .btn-small { padding: 8px 16px; font-size: 14px; width: auto; margin-top: 10px; }
        .link-btn { color: #4CAF50; text-decoration: none; font-weight: 600; }
        .app-content { display: none; }
        .nav-menu { 
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            padding: 15px; border-radius: 15px; margin-bottom: 20px;
            display: flex; justify-content: space-around; flex-wrap: wrap;
        }
        .nav-item { 
            background: #4CAF50; color: white; padding: 10px 20px; border-radius: 25px;
            text-decoration: none; margin: 5px; transition: all 0.3s; cursor: pointer;
        }
        .nav-item:hover, .nav-item.active { background: #45a049; transform: translateY(-2px); }
        .content-section { 
            display: none; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); margin-bottom: 20px;
        }
        .content-section.active { display: block; }
        .season-info { 
            background: linear-gradient(135deg, #81C784 0%, #4CAF50 100%);
            color: white; padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center;
        }
        .season-title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
        .season-organs { font-size: 18px; opacity: 0.9; }
        .cards-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .card { 
            background: #f8f9fa; padding: 20px; border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); transition: transform 0.3s;
        }
        .card:hover { transform: translateY(-5px); }
        .card-title { font-size: 18px; font-weight: bold; color: #4CAF50; margin-bottom: 10px; }
        .card-content { color: #666; line-height: 1.6; }
        .recipe-item { 
            background: white; padding: 20px; border-radius: 15px; margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08); cursor: pointer; transition: all 0.3s;
        }
        .recipe-item:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); }
        .recipe-title { font-size: 18px; font-weight: bold; color: #333; margin-bottom: 8px; }
        .recipe-meta { color: #4CAF50; font-size: 14px; margin-bottom: 10px; }
        .recipe-description { color: #666; line-height: 1.5; }

        /* AI Chat Styles */
        .ai-chat-button { 
            position: fixed; bottom: 20px; right: 20px; background: #4CAF50; color: white;
            width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center;
            justify-content: center; font-size: 24px; cursor: pointer; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s; border: none; z-index: 1000;
        }
        .ai-chat-button:hover { transform: scale(1.1); background: #45a049; }
        .chat-window { 
            display: none; position: fixed; bottom: 90px; right: 20px; width: 350px; height: 400px;
            background: white; border-radius: 15px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            flex-direction: column; z-index: 1000;
        }
        .chat-header { 
            background: #4CAF50; color: white; padding: 15px; border-radius: 15px 15px 0 0;
            font-weight: bold; display: flex; justify-content: space-between; align-items: center;
        }
        .chat-close { cursor: pointer; font-size: 18px; }
        .chat-messages { 
            flex: 1; padding: 15px; overflow-y: auto; max-height: 250px;
        }
        .chat-input-area { 
            padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px;
        }
        .chat-input { 
            flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none;
        }
        .chat-send { 
            background: #4CAF50; color: white; border: none; padding: 10px 15px;
            border-radius: 20px; cursor: pointer;
        }
        .message { 
            margin-bottom: 15px; padding: 10px 15px; border-radius: 15px; max-width: 80%; word-wrap: break-word;
        }
        .message.user { background: #4CAF50; color: white; margin-left: auto; }
        .message.ai { background: #f1f3f4; color: #333; }
        .message.loading { background: #e0e0e0; color: #666; font-style: italic; }

        /* API Settings */
        .api-settings { 
            background: #fff3cd; padding: 15px; border-radius: 10px; margin-bottom: 20px;
            border: 1px solid #ffeaa7;
        }
        .api-input { 
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-top: 10px;
        }
        .success-message { 
            background: #d4edda; color: #155724; padding: 10px; border-radius: 5px;
            margin-top: 10px; display: none;
        }
        .error-message { 
            background: #f8d7da; color: #721c24; padding: 10px; border-radius: 5px;
            margin-top: 10px; display: none;
        }
        .ai-recipe-generator { 
            background: #e8f5e8; padding: 20px; border-radius: 10px; margin-bottom: 20px;
            text-align: center;
        }
        .loading { opacity: 0.6; pointer-events: none; }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            .nav-menu { flex-direction: column; align-items: center; }
            .nav-item { margin: 3px 0; text-align: center; min-width: 120px; }
            .cards-grid { grid-template-columns: 1fr; }
            .chat-window { width: calc(100vw - 40px); height: 300px; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üåø HarmoniaTCM AI</div>
        <div class="subtitle">Sezonowo≈õƒá wed≈Çug Medycyny Chi≈Ñskiej z AI</div>
    </div>

    <div id="loginForm" class="login-form">
        <h2 style="text-align: center; margin-bottom: 30px; color: #333;">Zaloguj siƒô do HarmoniaTCM</h2>
        
        <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" placeholder="Wprowad≈∫ email">
        </div>
        
        <div class="form-group">
            <label for="password">Has≈Ço</label>
            <input type="password" id="password" placeholder="Wprowad≈∫ has≈Ço">
        </div>
        
        <button onclick="login()" class="btn">Zaloguj siƒô</button>
        
        <p style="text-align: center; margin-top: 20px;">
            Nie masz konta? <a href="#" onclick="showRegister()" class="link-btn">Zarejestruj siƒô</a>
        </p>
        
        <div style="margin-top: 20px; padding: 15px; background: #e8f5e8; border-radius: 10px; font-size: 14px;">
            <strong>Konto demo:</strong><br>
            Email: demo@harmonia.pl<br>
            Has≈Ço: demo123
        </div>
    </div>

    <div id="registerForm" class="login-form" style="display: none;">
        <h2 style="text-align: center; margin-bottom: 30px; color: #333;">Zarejestruj siƒô</h2>
        
        <div class="form-group">
            <label for="regEmail">Email</label>
            <input type="email" id="regEmail" placeholder="Wprowad≈∫ email">
        </div>
        
        <div class="form-group">
            <label for="regPassword">Has≈Ço</label>
            <input type="password" id="regPassword" placeholder="Wprowad≈∫ has≈Ço">
        </div>
        
        <button onclick="register()" class="btn">Zarejestruj siƒô</button>
        
        <p style="text-align: center; margin-top: 20px;">
            Masz ju≈º konto? <a href="#" onclick="showLogin()" class="link-btn">Zaloguj siƒô</a>
        </p>
    </div>

    <div id="appContent" class="app-content">
        <div class="container">
            <div class="nav-menu">
                <div class="nav-item active" onclick="showSection('home')">üè† G≈Ç√≥wna</div>
                <div class="nav-item" onclick="showSection('calendar')">üìÖ Kalendarz</div>
                <div class="nav-item" onclick="showSection('products')">ü•ó Produkty</div>
                <div class="nav-item" onclick="showSection('recipes')">üç≥ Przepisy</div>
                <div class="nav-item" onclick="showSection('profile')">üë§ Profil</div>
            </div>

            <div id="home" class="content-section active">
                <div class="season-info">
                    <div class="season-title">üå∏ Wiosna (13 lutego - 25 kwietnia)</div>
                    <div class="season-organs">WƒÖtroba ‚Ä¢ Pƒôcherzyk ≈ª√≥≈Çciowy ‚Ä¢ ≈ªywio≈Ç Drzewo</div>
                </div>
                
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">ü§ñ AI Zalecenia na dzi≈õ</div>
                        <div class="card-content">
                            ‚Ä¢ Spo≈ºywaj ≈õwie≈ºe kie≈Çki i m≈Çode warzywa<br>
                            ‚Ä¢ Pij ciep≈ÇƒÖ wodƒô z cytrynƒÖ rano<br>
                            ‚Ä¢ Wykonuj ≈Çagodne ƒáwiczenia rozciƒÖgajƒÖce<br>
                            ‚Ä¢ Unikaj nadmiernie t≈Çustych potraw<br>
                            <button class="btn btn-small" onclick="getAIRecommendations()">Pobierz AI zalecenia</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">Balans energetyczny</div>
                        <div class="card-content">
                            <strong>DominujƒÖcy smak:</strong> Kwa≈õny<br>
                            <strong>Termika:</strong> Ciep≈Ça, rozgrzewajƒÖca<br>
                            <strong>Emocje:</strong> Cierpliwo≈õƒá, planowanie<br>
                            <strong>Aktywno≈õƒá:</strong> Umiarkowana
                        </div>
                    </div>
                </div>
            </div>

            <div id="calendar" class="content-section">
                <h2 style="margin-bottom: 30px; text-align: center;">üìÖ Kalendarz TCM</h2>
                
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">üå± Wiosna (13 luty - 25 kwiecie≈Ñ)</div>
                        <div class="card-content">
                            <strong>Organy:</strong> WƒÖtroba, Pƒôcherzyk ≈ª√≥≈Çciowy<br>
                            <strong>≈ªywio≈Ç:</strong> Drzewo<br>
                            <strong>Smak:</strong> Kwa≈õny<br>
                            <strong>Charakterystyka:</strong> Czas odnowy i wzrostu
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">‚òÄÔ∏è Lato (14 maj - 25 lipiec)</div>
                        <div class="card-content">
                            <strong>Organy:</strong> Serce, Jelito Cienkie<br>
                            <strong>≈ªywio≈Ç:</strong> Ogie≈Ñ<br>
                            <strong>Smak:</strong> Gorzki<br>
                            <strong>Charakterystyka:</strong> Czas maksymalnej aktywno≈õci
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üçÇ Jesie≈Ñ (13 sierpie≈Ñ - 25 pa≈∫dziernik)</div>
                        <div class="card-content">
                            <strong>Organy:</strong> P≈Çuca, Jelito Grube<br>
                            <strong>≈ªywio≈Ç:</strong> Metal<br>
                            <strong>Smak:</strong> Ostry<br>
                            <strong>Charakterystyka:</strong> Czas zbior√≥w i przygotowa≈Ñ
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">‚ùÑÔ∏è Zima (13 listopad - 25 stycze≈Ñ)</div>
                        <div class="card-content">
                            <strong>Organy:</strong> Nerki, Pƒôcherz Moczowy<br>
                            <strong>≈ªywio≈Ç:</strong> Woda<br>
                            <strong>Smak:</strong> S≈Çony<br>
                            <strong>Charakterystyka:</strong> Czas regeneracji i oszczƒôdzania energii
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üåæ Dojo (okresy przej≈õciowe)</div>
                        <div class="card-content">
                            <strong>Organy:</strong> ≈öledziona, ≈ªo≈ÇƒÖdek<br>
                            <strong>≈ªywio≈Ç:</strong> Ziemia<br>
                            <strong>Smak:</strong> S≈Çodki<br>
                            <strong>Charakterystyka:</strong> 18-dniowe okresy harmonii i r√≥wnowagi
                        </div>
                    </div>
                </div>
            </div>

            <div id="products" class="content-section">
                <h2 style="margin-bottom: 30px; text-align: center;">ü•ó Produkty sezonowe na Wiosnƒô</h2>
                
                <div style="text-align: center; margin-bottom: 20px;">
                    <button class="btn btn-small" onclick="getAIProductRecommendations()">ü§ñ AI rekomendacje produkt√≥w</button>
                </div>
                
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">üå± Kie≈Çki i m≈Çode warzywa</div>
                        <div class="card-content">
                            <strong>Przyk≈Çady:</strong> Kie≈Çki lucerny, broku≈Ç, rukola<br>
                            <strong>W≈Ça≈õciwo≈õci:</strong> OczyszczajƒÖce, regenerujƒÖce<br>
                            <strong>Wp≈Çyw na organy:</strong> Wspiera wƒÖtrobƒô<br>
                            <strong>Termika:</strong> Ch≈ÇodzƒÖca, ≈õwie≈ºa
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üßÖ Warzywa oczyszczajƒÖce</div>
                        <div class="card-content">
                            <strong>Przyk≈Çady:</strong> Szczypior, czosnek m≈Çody, cebula<br>
                            <strong>W≈Ça≈õciwo≈õci:</strong> DetoksykujƒÖce, antybakteryjne<br>
                            <strong>Wp≈Çyw na organy:</strong> Oczyszcza wƒÖtrobƒô<br>
                            <strong>Termika:</strong> Ciep≈Ça, stymulujƒÖca
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üçã Produkty kwa≈õne</div>
                        <div class="card-content">
                            <strong>Przyk≈Çady:</strong> Cytryna, ocet jab≈Çkowy, kwas<br>
                            <strong>W≈Ça≈õciwo≈õci:</strong> WspomagajƒÖce trawienie<br>
                            <strong>Wp≈Çyw na organy:</strong> Harmonizuje wƒÖtrobƒô<br>
                            <strong>Termika:</strong> Neutralna, r√≥wnowa≈ºƒÖca
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üåø Zio≈Ça wiosenne</div>
                        <div class="card-content">
                            <strong>Przyk≈Çady:</strong> Pokrzywa, mlecz, mniszek<br>
                            <strong>W≈Ça≈õciwo≈õci:</strong> OczyszczajƒÖce krew<br>
                            <strong>Wp≈Çyw na organy:</strong> Wspiera uk≈Çad krƒÖ≈ºenia<br>
                            <strong>Termika:</strong> Ch≈ÇodzƒÖca, detoksykujƒÖca
                        </div>
                    </div>
                </div>
            </div>

            <div id="recipes" class="content-section">
                <h2 style="margin-bottom: 30px; text-align: center;">üç≥ Przepisy wiosenne</h2>
                
                <div class="ai-recipe-generator">
                    <h3>ü§ñ Generator przepis√≥w AI</h3>
                    <p>Pozw√≥l AI stworzyƒá spersonalizowany przepis zgodny z TCM!</p>
                    <button class="btn btn-small" onclick="generateAIRecipe()">Generuj przepis AI</button>
                </div>
                
                <div class="recipe-item">
                    <div class="recipe-title">üå± Wiosenna zupa detoks</div>
                    <div class="recipe-meta">Czas przygotowania: 30 min ‚Ä¢ Porcje: 4 ‚Ä¢ W≈Ça≈õciwo≈õci: OczyszczajƒÖce</div>
                    <div class="recipe-description">Lekka zupa z m≈Çodych warzyw, pokrzywy i zi√≥≈Ç zgodna z zasadami wiosennego oczyszczania wed≈Çug TCM.</div>
                </div>
                
                <div class="recipe-item">
                    <div class="recipe-title">ü•ó Sa≈Çatka z kie≈Çkami</div>
                    <div class="recipe-meta">Czas przygotowania: 15 min ‚Ä¢ Porcje: 2 ‚Ä¢ W≈Ça≈õciwo≈õci: RegenerujƒÖce</div>
                    <div class="recipe-description">≈öwie≈ºa sa≈Çatka z r√≥≈ºnych kie≈Çk√≥w, m≈Çodych li≈õci i dressingiem z octu jab≈Çkowego.</div>
                </div>
                
                <div class="recipe-item">
                    <div class="recipe-title">üçö Kleik ry≈ºowy z kie≈Çkami</div>
                    <div class="recipe-meta">Czas przygotowania: 45 min ‚Ä¢ Porcje: 2 ‚Ä¢ W≈Ça≈õciwo≈õci: ≈ÅagodzƒÖce</div>
                    <div class="recipe-description">Tradycyjny chi≈Ñski kleik z dodatkiem ≈õwie≈ºych kie≈Çk√≥w i delikatnych przypraw.</div>
                </div>
            </div>

            <div id="profile" class="content-section">
                <h2 style="margin-bottom: 30px; text-align: center;">üë§ Tw√≥j profil TCM</h2>
                
                <div class="api-settings">
                    <h3>üîë Ustawienia OpenAI API</h3>
                    <p>Aby korzystaƒá z funkcji AI, wprowad≈∫ sw√≥j klucz API OpenAI:</p>
                    <input type="password" id="apiKey" class="api-input" placeholder="sk-proj-..." value="">
                    <button onclick="saveApiKey()" class="btn btn-small">Zapisz klucz API</button>
                    <div id="apiSuccess" class="success-message">Klucz API zosta≈Ç zapisany!</div>
                    <div id="apiError" class="error-message">Wprowad≈∫ poprawny klucz API!</div>
                    <p style="margin-top: 10px; font-size: 12px; color: #666;">
                        Potrzebujesz klucz? <a href="https://platform.openai.com/api-keys" target="_blank">Utw√≥rz tutaj</a>
                    </p>
                </div>
                
                <div class="cards-grid">
                    <div class="card">
                        <div class="card-title">üß¨ AI Analiza konstytucji</div>
                        <div class="card-content">
                            <strong>DominujƒÖcy ≈ºywio≈Ç:</strong> Drzewo (60%)<br>
                            <strong>Drugorzƒôdny:</strong> Woda (25%)<br>
                            <strong>Konstytucja:</strong> Typ artysty/kreatora<br>
                            <button class="btn btn-small" onclick="getAIConstitutionAnalysis()">Analiza AI</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üìä Twoje statystyki</div>
                        <div class="card-content">
                            <strong>Dni u≈ºywania aplikacji:</strong> <span id="daysUsed">1</span><br>
                            <strong>Zapytania AI:</strong> <span id="aiQueries">0</span><br>
                            <strong>Przepisy AI:</strong> <span id="aiRecipes">0</span><br>
                            <strong>Postƒôpy:</strong> Bardzo dobre
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-title">üí° AI Personalizowane zalecenia</div>
                        <div class="card-content" id="aiRecommendations">
                            ‚Ä¢ Zwiƒôksz spo≈ºycie produkt√≥w kwa≈õnych<br>
                            ‚Ä¢ Ogranicz s≈Çodycze wieczorem<br>
                            ‚Ä¢ Dodaj wiƒôcej ƒáwicze≈Ñ rozciƒÖgajƒÖcych<br>
                            ‚Ä¢ Pij ciep≈Çe napoje rano<br>
                            <button class="btn btn-small" onclick="getPersonalizedAIRecommendations()">Od≈õwie≈º AI zalecenia</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat -->
    <button class="ai-chat-button" onclick="toggleChat()">ü§ñ</button>
    
    <div id="chatWindow" class="chat-window">
        <div class="chat-header">
            ü§ñ Asystent TCM AI
            <span class="chat-close" onclick="toggleChat()">‚úï</span>
        </div>
        <div id="chatMessages" class="chat-messages">
            <div class="message ai">Cze≈õƒá! Jestem Twoim AI asystentem TCM. Mogƒô odpowiedzieƒá na pytania o medycynƒô chi≈ÑskƒÖ, sezonowo≈õƒá, receptury i wiele wiƒôcej! Zadaj mi pytanie.</div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" class="chat-input" placeholder="Zadaj pytanie AI..." onkeypress="handleChatEnter(event)">
            <button class="chat-send" onclick="sendChatMessage()">Wy≈õlij</button>
        </div>
    </div>

    <script>
        // Application state
        let currentUser = null;
        let isLoggedIn = false;
        let chatOpen = false;
        let userStats = {
            daysUsed: 1,
            aiQueries: 0,
            aiRecipes: 0
        };

        const demoUsers = {
            'demo@harmonia.pl': { password: 'demo123', name: 'Demo User' }
        };

        // Initialize app
        window.addEventListener('load', function() {
            checkAutoLogin();
            loadUserStats();
        });

        function checkAutoLogin() {
            const savedUser = localStorage.getItem('harmonia_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showApp();
            }
        }

        function loadUserStats() {
            const stats = localStorage.getItem('harmonia_stats');
            if (stats) {
                userStats = JSON.parse(stats);
                updateStatsDisplay();
            }
        }

        function updateStatsDisplay() {
            if (document.getElementById('daysUsed')) {
                document.getElementById('daysUsed').textContent = userStats.daysUsed;
                document.getElementById('aiQueries').textContent = userStats.aiQueries;
                document.getElementById('aiRecipes').textContent = userStats.aiRecipes;
            }
        }
